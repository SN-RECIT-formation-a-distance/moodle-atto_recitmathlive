YUI.add("moodle-atto_recitmathlive-button",function(o,t){o.namespace("M.atto_recitmathlive").Button=o.Base.create("button",o.M.editor_atto.EditorPlugin,[],{TEMPLATE:'<div style="margin-bottom:20px"><math-field id="{{component}}input" virtual-keyboard-mode="onfocus">{{content}}</math-field></div><button id="{{component}}close" class="btn btn-secondary">{{get_string "close" component}}</button><button class="btn btn-secondary" id="{{component}}submit"> {{get_string "save" component}}</button></div>',COMPONENTNAME:"atto_recitmathlive",_currentSelection:null,_content:null,stream:null,math:null,initializer:function(){var t,e;this.get("host").canShowFilepicker("media")&&(this.addButton({title:"pluginname",icon:"e/math",iconComponent:this.COMPONENTNAME,callback:this.open,buttonName:"recitmathlive"}),t=M.cfg.wwwroot+"/lib/editor/atto/plugins/recitmathlive/js/mathlive.min.js",e=this,requirejs([t],function(t){e.math=t}))},getSelectedNode:function(){var t=document.getSelection().anchorNode;return 3==t.nodeType?t.parentNode:t},open:function(){var n,t,e,i;this.dialogue=this.getDialogue({headerContent:M.util.get_string("pluginname",this.COMPONENTNAME),focusAfterHide:!0,width:"auto",height:"auto"}),(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i))&&window.scrollTo(0,1),e="f(x)=",(t=this.getSelectedNode())&&t.classList.contains(this.COMPONENTNAME)&&(e=(this.selectedNode=t).innerHTML.replace("\\ "," ").replace("\\(","").replace("\\)","")),t=o.Handlebars.compile(this.TEMPLATE),e=o.Node.create(t({elementid:this.get("host").get("elementid"),component:this.COMPONENTNAME,content:e,width:.8*window.innerWidth,height:.8*window.innerHeight})),this.dialogue.set("bodyContent",e).show(),n=document.getElementById(this.COMPONENTNAME+"input"),t=document.getElementById(this.COMPONENTNAME+"close"),e=document.getElementById(this.COMPONENTNAME+"submit"),i=this,t.addEventListener("click",function(t){t.preventDefault(),i.close()}),e.addEventListener("click",function(t){var e;t.preventDefault(),e="\\("+(e=(e=n.getValue("latex")).replace(" ","\\ "))+"\\)",(t=i.get("host")).focus(),t.restoreSelection(),i.selectedNode?i.selectedNode.innerHTML=e:t.insertContentAtFocusPoint("<span class='"+i.COMPONENTNAME+"'>"+e+"</span>"),i.markUpdated(),i.close()},!1)},close:function(){this.getDialogue({focusAfterHide:null}).hide(),this.selectedNode=null}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});